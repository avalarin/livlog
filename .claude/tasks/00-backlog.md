# Tasks

**improvements**
- ✅ refactor: Убрать экран SmartAddEntry и кнопку на экране ContentView для перехода в SmartAddEntry
- feature: На экран AddEntryView добавить кнопку для добавления новой коллекции прямо в момент создания новой записи, кнопка должна быть справа от списка коллекций
- ✅ bugfix: На экране ContentView в режиме Grid нужно сделать так, чтобы ячейки были одной ширины, даже если картинка шире. И чтобы ячейки в одной строке выравнивались по верхнему краю
- feature: Сделать реальную отправку email кода на почту пользователя
- feature: Починить вход через Apple
- bugfix: После pull to rerfresh на главном экране перестают работать фильтры по коллекции
- bugfix: Ожидается что после создания новой entry она появится на главном экране сразу. Фактически появляется только после перезагрузки
- feature: Добавить кнопку "выход" в меню настроек
- feature: Добавить множественный выбор entries и множественные действия: удаление, перемещение в коллекцию
- feature: Добавить возможность делать Reorder на главный экран
- ✅ bugfix: Ожидается что в Gallery / List представлениях будет видно обложки у Entries. Фактически их не видно.

**backend performance and observability**
- ✅ fix: Не нужно логировать запросы в ручку /health, их слишком много

**ui smoothness**
- ui-fix: Экран просмотра и редактирования коллекций должен открываться сразу и на нем должна быть загрузка. Сейчас при нажатии на кнопку коллекций происходит загрузка и зависание.
- ui-fix: При создании коллекции, при нажатии на кнопку Save на ней должен появляться индикатор загрузки. Переход на прошлый экран только после сохранения. Сейчас происходит переход назад и через секунду появляется новая коллекция.
- ui-fix: Когда делаешь pull to refresh он должен покрутиться минимум 1.5 секунды, даже если запрос быстрее отработал. Сейчас исчезает моментально и это выглядит плохо.
- ui-fix: Перенести кнопку создания новой entry на главном экране в нижний правый угол. А кнопку настроек перенести направо. Кнопку выбора представления перенести внутрь настроек и назвать "View as List" / "View as Gallery"
- ui-fix: В полях Name в CollectionsView, Title/Description в AddEntryView максимальная длина должна ограничиваться валидацией поля. Поле должно показывать что длина превышена (стандартным визуальным способом Apple). Сейчас можно ввести сколько угодно текста и потом при сохранении появляется Alert, что не удобно.

** ✅ backend**
Epic: нужно добавить backend для работы с AI поиском и для хранения коллекций

- ✅ 16-research-backend-api: research: Описать контракты для Backend API: AI поиск, получение списка коллекций, получение списка entries. Описать контракты в docs/api.md
- ✅ 17-research-auth: research: Провести исследование как сделать авторизацию пользователя в API, чтобы сейчас работал только вход через apple id, но в будущем также можно было вход по email подключить. Описать в docs/auth.md и обновить контракты в docs/api.md
- ✅ 18-design-database-schema: research: Спроектировать схему БД согласно docs/user-scenarios.md и docs/api.md. Поместить результат в docs/database.md. В файле должен быть список таблиц, для каждой таблицы описание для чего она, список колонок, описание индексов, внешних связей, как будут использоваться данные в таблице, какие запросы и как их оптимизировать. Список колонок должен содержать название, тип, наличие индекса, внешние связи, описание колонки.
- ✅ 19-initial-backend-setup: feature: Разработать backend сервис на golang в директории backend прямо в этом репозитории, для начала только простую ручку healthcheck. Добавить линтер, команду для запуска тестов, команду для сборки. Добавить Dockerfile, команду для сборки в докер и docker-compose. Добавить postgresql БД с миграциями. Добавить возможность получать конфигурацию сервиса из файла.
- ✅ 20-implement-apple-id-auth 21-implement-email-auth: feature: Добавить логику авторизации пользователя через Apple Id и Email Code
- ✅ 23-migrate-ai-search-to-backend: feature: Нужно перенести логику OpenAIService на бэкенд, реализовать ручку для поиска согласно контрактам в docs/api.md. Токен для подключения должен получаться из файла. Добавить лимиты для пользователей: не больше 5 запросов к AI в день. Настройка количества запросов и периода должны получаться из файла. Сразу нужно заложить что экземпляров бэкенд сервиса может быть несколько, поэтому нужно информацию о лимите хранить в базе.
- ✅ 22-migrate-to-backend-storage: feature: Нужно перенести хранение коллекций и entries на бэкенд. В структуре базы предусмотреть что в будущем пользователь сможет давать доступ к своей коллекции другим пользователям, но сейчас эту функцию не реализовывать. Ничего страшного если данные которые сейчас сохранены в ios storage потеряются. При нажатии на кнопку заполнения тестовых данных они должны сохраняться на бэкенд. Внутренее хранилище icloud не использовать вообще. Сохранение может занимать время, поэтому нужно на все кнопки сохранения и удаления добавить визуализацию прогресса и обработку ошибок. 

